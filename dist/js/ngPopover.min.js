var app=angular.module("ngPopover",[]);app.directive("ngPopover",function(){return{restrict:"EA",scope:{direction:"@",trigger:"@",onClose:"&",onOpen:"&",popoverClass:"@"},replace:!0,transclude:!0,link:function(e,r,t,n){n.document;e.show=!1,e.popoverClass=t.popoverClass,e.style={width:t.width,height:t.height};var o,i,s=angular.element("#"+e.trigger),a=angular.element('.generic-dropdown[trigger="'+e.trigger+'"]');e.dropDirection=t.direction||"bottom",s.bind("click",function(r){var t=angular.element("#"+e.trigger),o=angular.element('.generic-dropdown[trigger="'+e.trigger+'"]');r.preventDefault(),l(t,o),angular.element(".generic-dropdown").not('[trigger="'+e.trigger+'"]').addClass("hide"),o.toggleClass("hide"),o.hasClass("hide")?(n.unregisterBodyListener(),e.onClose(),e.$apply()):(n.registerBodyListener(),e.onOpen(),e.$apply())}),a.bind("click",function(e){e.stopPropagation()});var d=function(){return s.offset()},l=function(r,t){switch(e.dropDirection){case"left":var n=t.toggleClass("hide").outerWidth();t.toggleClass("hide"),o=d().left-n-10+"px",i=d().top+"px";break;case"right":o=d().left+r.outerWidth()+10+"px",i=d().top+"px";break;case"top":var s=t.toggleClass("hide").outerHeight();t.toggleClass("hide"),o=d().left+"px",i=d().top-s-10+"px";break;default:o=d().left+"px",i=d().top+r.outerHeight()+10+"px"}t.css({position:"absolute",left:o,top:i})};l(s,a)},controller:["$scope",function(e){var r=function(t){var n=t.target,o=!1;do if(n!=document&&n.classList&&(n.classList.contains("generic-dropdown")||n.classList.contains("ng-popover-trigger"))){o=!0;break}while(n=n.parentNode);o||(angular.element(".generic-dropdown").addClass("hide"),document.body.removeEventListener("click",r),e.onClose(),e.$apply())};this.registerBodyListener=function(){document.body.addEventListener("click",r)},this.unregisterBodyListener=function(){document.body.removeEventListener("click",r)}}],template:'<div class="generic-dropdown hide" ng-style="style"><div class="generic-dropdown-wrapper {{dropDirection}}"><div class="generic-dropdown-content" ng-class="popoverClass"><ng-transclude></ng-transclude></div></div></div>'}}),app.service("genericDropdownService",function(){return{closeDropdown:function(e){angular.element(".generic-dropdown[trigger="+e+"]").addClass("hide")},closeAll:function(){angular.element(".generic-dropdown").addClass("hide")}}});