var app=angular.module("ngPopover",[]);app.directive("ngPopover",function(){return{restrict:"EA",scope:{direction:"@",trigger:"@",onClose:"&",onOpen:"&",popoverClass:"@"},replace:!0,transclude:!0,link:function(e,t,o,r){r.document;e.show=!1,e.popoverClass=o.popoverClass,e.style={width:o.width,height:o.height};var n,i,s=angular.element("#"+e.trigger),a=angular.element('.ng-popover[trigger="'+e.trigger+'"]');e.dropDirection=o.direction||"bottom",s.bind("click",function(t){var o=angular.element("#"+e.trigger),n=angular.element('.ng-popover[trigger="'+e.trigger+'"]');t.preventDefault(),p(o,n),angular.element(".ng-popover").not('[trigger="'+e.trigger+'"]').addClass("hide"),n.toggleClass("hide"),n.hasClass("hide")?(r.unregisterBodyListener(),e.onClose(),e.$apply()):(r.registerBodyListener(),e.onOpen(),e.$apply())});var l=function(){return s.offset()},p=function(t,o){switch(e.dropDirection){case"left":var r=o.toggleClass("hide").outerWidth();o.toggleClass("hide"),n=l().left-r-10+"px",i=l().top+"px";break;case"right":n=l().left+t.outerWidth()+10+"px",i=l().top+"px";break;case"top":var s=o.toggleClass("hide").outerHeight();o.toggleClass("hide"),n=l().left+"px",i=l().top-s-10+"px";break;default:n=l().left+"px",i=l().top+t.outerHeight()+10+"px"}o.css({position:"absolute",left:n,top:i})};p(s,a)},controller:["$scope",function(e){var t=function(o){var r=o.target,n=!1;do if(r!=document&&r.classList&&(r.classList.contains("ng-popover")||r.classList.contains("ng-popover-trigger"))){n=!0;break}while(r=r.parentNode);n||(angular.element(".ng-popover").addClass("hide"),document.body.removeEventListener("click",t),e.onClose(),e.$apply())};this.registerBodyListener=function(){document.body.addEventListener("click",t)},this.unregisterBodyListener=function(){document.body.removeEventListener("click",t)}}],template:'<div class="ng-popover hide" ng-style="style"><div class="ng-popover-wrapper {{dropDirection}}"><div class="ng-popover-content" ng-class="popoverClass"><ng-transclude></ng-transclude></div></div></div>'}}),app.factory("ngPopoverFactory",function(){return{closePopover:function(e){angular.element(".ng-popover[trigger="+e+"]").addClass("hide")},closeAll:function(){angular.element(".ng-popover").addClass("hide")}}});